{"version":3,"sources":["../../server/middleware/authorize.js"],"names":["verifyToken","req","res","next","checkHeader","headers","authorization","bearer","split","token","jwt","verify","err","encoded","status","json","data"],"mappings":";;;;;;;AAAA;;;;AAEA,IAAMA,WAAW,GAAG,SAAdA,WAAc,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACtC,MAAMC,WAAW,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAAhC;;AAEA,MAAI,OAAOF,WAAP,KAAuB,WAA3B,EAAwC;AACtC,QAAMG,MAAM,GAAGH,WAAW,CAACI,KAAZ,CAAkB,GAAlB,CAAf;AACA,QAAMC,KAAK,GAAGF,MAAM,CAAC,CAAD,CAApB;;AACAG,6BAAIC,MAAJ,CAAWF,KAAX,EAAkB,WAAlB,EAA+B,UAACG,GAAD,EAAMC,OAAN,EAAkB;AAC/C,UAAID,GAAJ,EAAS;AACPV,QAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBD,UAAAA,MAAM,EAAE,GADW;AAEnBE,UAAAA,IAAI,EAAE;AAFa,SAArB;AAID;;AACDf,MAAAA,GAAG,CAACY,OAAJ,GAAcA,OAAd;AACAV,MAAAA,IAAI;AACL,KATD;AAUD,GAbD,MAaO;AACLD,IAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB;AACD;AACF,CAnBD;;eAqBef,W","sourcesContent":["import jwt from 'jsonwebtoken';\n\nconst verifyToken = (req, res, next) => {\n  const checkHeader = req.headers.authorization;\n\n  if (typeof checkHeader !== 'undefined') {\n    const bearer = checkHeader.split(' ');\n    const token = bearer[1];\n    jwt.verify(token, 'secretkey', (err, encoded) => {\n      if (err) {\n        res.status(401).json({\n          status: 401,\n          data: 'Unauthorized access',\n        });\n      }\n      req.encoded = encoded;\n      next();\n    });\n  } else {\n    res.status(403).json();\n  }\n};\n\nexport default verifyToken;\n"],"file":"authorize.js"}